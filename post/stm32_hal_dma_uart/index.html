<!doctype html><html lang=zh-hans><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>STM32通过DMA接收不定长串口数据 | Garson's Blog</title>
<link rel=canonical href=https://garnote.top/post/stm32_hal_dma_uart/><meta itemprop=name content="STM32通过DMA接收不定长串口数据"><meta name=description content="半年多前做课设，用到HAL库，体验上，用STM32CubeMX和HAL库开发真的很快，但是代码效率确实低不少。 在课设中GPS模块用的串口传输。为了处理接收方便，使用串口的Idle中断来实现串口的不定长接收，再配合DMA就可以减轻CPU负担，把算力分配到更重要的任务上。文中讨论内容适用于Normal模式的DMA。
Idle中断就是空闲中断，当总线上在一个字节对应的周期内未再有新的数据接收时，就会触发中断。
使用HAL的串口DMA 在STM32CubeMX里面的配置就不说了。 主要用到下面两个函数：
1HAL_StatusTypeDef HAL_UARTEx_ReceiveToIdle_DMA(UART_HandleTypeDef *huart, uint8_t *pData, uint16_t Size) 2 3__weak void HAL_UARTEx_RxEventCallback(UART_HandleTypeDef *huart, uint16_t Size) HAL_UARTEx_RxEventCallback()是串口事件回调函数之一。
Reception is initiated by this function call. Further progress of reception is achieved thanks to DMA services, transferring automatically received data elements in user reception buffer and calling registered callbacks at half/end of reception. UART IDLE events are also used to consider reception phase as ended. In all cases, callback execution will indicate number of received data elements."><meta name=datePublished content="2022-02-06T12:46:00+08:00"><meta name=dateModified content="2022-02-06T12:46:00+08:00"><meta itemprop=wordCount content="103"><meta name=keywords content="Sensor,DMA,Uart"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:url" content="https://garnote.top/post/stm32_hal_dma_uart/"><meta property="og:site_name" content="Garson's Blog"><meta property="og:title" content="STM32通过DMA接收不定长串口数据"><meta property="og:description" content="半年多前做课设，用到HAL库，体验上，用STM32CubeMX和HAL库开发真的很快，但是代码效率确实低不少。 在课设中GPS模块用的串口传输。为了处理接收方便，使用串口的Idle中断来实现串口的不定长接收，再配合DMA就可以减轻CPU负担，把算力分配到更重要的任务上。文中讨论内容适用于Normal模式的DMA。
Idle中断就是空闲中断，当总线上在一个字节对应的周期内未再有新的数据接收时，就会触发中断。
使用HAL的串口DMA 在STM32CubeMX里面的配置就不说了。 主要用到下面两个函数：
1HAL_StatusTypeDef HAL_UARTEx_ReceiveToIdle_DMA(UART_HandleTypeDef *huart, uint8_t *pData, uint16_t Size) 2 3__weak void HAL_UARTEx_RxEventCallback(UART_HandleTypeDef *huart, uint16_t Size) HAL_UARTEx_RxEventCallback()是串口事件回调函数之一。
Reception is initiated by this function call. Further progress of reception is achieved thanks to DMA services, transferring automatically received data elements in user reception buffer and calling registered callbacks at half/end of reception. UART IDLE events are also used to consider reception phase as ended. In all cases, callback execution will indicate number of received data elements."><meta property="og:locale" content="zh_hans"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-02-06T12:46:00+08:00"><meta property="article:modified_time" content="2022-02-06T12:46:00+08:00"><meta property="article:tag" content="Sensor"><meta property="article:tag" content="DMA"><meta property="article:tag" content="Uart"><meta name=twitter:card content="summary"><meta name=twitter:title content="STM32通过DMA接收不定长串口数据"><meta name=twitter:description content="半年多前做课设，用到HAL库，体验上，用STM32CubeMX和HAL库开发真的很快，但是代码效率确实低不少。 在课设中GPS模块用的串口传输。为了处理接收方便，使用串口的Idle中断来实现串口的不定长接收，再配合DMA就可以减轻CPU负担，把算力分配到更重要的任务上。文中讨论内容适用于Normal模式的DMA。
Idle中断就是空闲中断，当总线上在一个字节对应的周期内未再有新的数据接收时，就会触发中断。
使用HAL的串口DMA 在STM32CubeMX里面的配置就不说了。 主要用到下面两个函数：
1HAL_StatusTypeDef HAL_UARTEx_ReceiveToIdle_DMA(UART_HandleTypeDef *huart, uint8_t *pData, uint16_t Size) 2 3__weak void HAL_UARTEx_RxEventCallback(UART_HandleTypeDef *huart, uint16_t Size) HAL_UARTEx_RxEventCallback()是串口事件回调函数之一。
Reception is initiated by this function call. Further progress of reception is achieved thanks to DMA services, transferring automatically received data elements in user reception buffer and calling registered callbacks at half/end of reception. UART IDLE events are also used to consider reception phase as ended. In all cases, callback execution will indicate number of received data elements."><link rel=stylesheet href=https://garnote.top/css/styles.0638400b19bd56a5de8f688506b98a3a1a098ed4bd980bd6869adee28f2e9cef1d56429822a38036ff6aa79daacbae3cd7edce9c7f90ed40ad8aaa4dbb5fb182.css integrity="sha512-BjhACxm9VqXej2iFBrmKOhoJjtS9mAvWhpre4o8unO8dVkKYIqOANv9qp52qy6481+3OnH+Q7UCtiqpNu1+xgg=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel="shortcut icon" href=https://pic.garnote.top/eeb6915d14722.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/post>Writings</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li><li><a href=/search>Search</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://garnote.top/post/win10_reboot/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f&text=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f&title=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f&is_video=false&description=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae&body=Check out this article: https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f&title=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f&title=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f&name=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae&description=%e5%8d%8a%e5%b9%b4%e5%a4%9a%e5%89%8d%e5%81%9a%e8%af%be%e8%ae%be%ef%bc%8c%e7%94%a8%e5%88%b0HAL%e5%ba%93%ef%bc%8c%e4%bd%93%e9%aa%8c%e4%b8%8a%ef%bc%8c%e7%94%a8STM32CubeMX%e5%92%8cHAL%e5%ba%93%e5%bc%80%e5%8f%91%e7%9c%9f%e7%9a%84%e5%be%88%e5%bf%ab%ef%bc%8c%e4%bd%86%e6%98%af%e4%bb%a3%e7%a0%81%e6%95%88%e7%8e%87%e7%a1%ae%e5%ae%9e%e4%bd%8e%e4%b8%8d%e5%b0%91%e3%80%82%20%e5%9c%a8%e8%af%be%e8%ae%be%e4%b8%adGPS%e6%a8%a1%e5%9d%97%e7%94%a8%e7%9a%84%e4%b8%b2%e5%8f%a3%e4%bc%a0%e8%be%93%e3%80%82%e4%b8%ba%e4%ba%86%e5%a4%84%e7%90%86%e6%8e%a5%e6%94%b6%e6%96%b9%e4%be%bf%ef%bc%8c%e4%bd%bf%e7%94%a8%e4%b8%b2%e5%8f%a3%e7%9a%84Idle%e4%b8%ad%e6%96%ad%e6%9d%a5%e5%ae%9e%e7%8e%b0%e4%b8%b2%e5%8f%a3%e7%9a%84%e4%b8%8d%e5%ae%9a%e9%95%bf%e6%8e%a5%e6%94%b6%ef%bc%8c%e5%86%8d%e9%85%8d%e5%90%88DMA%e5%b0%b1%e5%8f%af%e4%bb%a5%e5%87%8f%e8%bd%bbCPU%e8%b4%9f%e6%8b%85%ef%bc%8c%e6%8a%8a%e7%ae%97%e5%8a%9b%e5%88%86%e9%85%8d%e5%88%b0%e6%9b%b4%e9%87%8d%e8%a6%81%e7%9a%84%e4%bb%bb%e5%8a%a1%e4%b8%8a%e3%80%82%e6%96%87%e4%b8%ad%e8%ae%a8%e8%ae%ba%e5%86%85%e5%ae%b9%e9%80%82%e7%94%a8%e4%ba%8eNormal%e6%a8%a1%e5%bc%8f%e7%9a%84DMA%e3%80%82%0aIdle%e4%b8%ad%e6%96%ad%e5%b0%b1%e6%98%af%e7%a9%ba%e9%97%b2%e4%b8%ad%e6%96%ad%ef%bc%8c%e5%bd%93%e6%80%bb%e7%ba%bf%e4%b8%8a%e5%9c%a8%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e5%af%b9%e5%ba%94%e7%9a%84%e5%91%a8%e6%9c%9f%e5%86%85%e6%9c%aa%e5%86%8d%e6%9c%89%e6%96%b0%e7%9a%84%e6%95%b0%e6%8d%ae%e6%8e%a5%e6%94%b6%e6%97%b6%ef%bc%8c%e5%b0%b1%e4%bc%9a%e8%a7%a6%e5%8f%91%e4%b8%ad%e6%96%ad%e3%80%82%0a%e4%bd%bf%e7%94%a8HAL%e7%9a%84%e4%b8%b2%e5%8f%a3DMA%20%e5%9c%a8STM32CubeMX%e9%87%8c%e9%9d%a2%e7%9a%84%e9%85%8d%e7%bd%ae%e5%b0%b1%e4%b8%8d%e8%af%b4%e4%ba%86%e3%80%82%20%e4%b8%bb%e8%a6%81%e7%94%a8%e5%88%b0%e4%b8%8b%e9%9d%a2%e4%b8%a4%e4%b8%aa%e5%87%bd%e6%95%b0%ef%bc%9a%0a1HAL_StatusTypeDef%20HAL_UARTEx_ReceiveToIdle_DMA%28UART_HandleTypeDef%20%2ahuart%2c%20uint8_t%20%2apData%2c%20uint16_t%20Size%29%202%203__weak%20void%20HAL_UARTEx_RxEventCallback%28UART_HandleTypeDef%20%2ahuart%2c%20uint16_t%20Size%29%20HAL_UARTEx_RxEventCallback%28%29%e6%98%af%e4%b8%b2%e5%8f%a3%e4%ba%8b%e4%bb%b6%e5%9b%9e%e8%b0%83%e5%87%bd%e6%95%b0%e4%b9%8b%e4%b8%80%e3%80%82%0aReception%20is%20initiated%20by%20this%20function%20call.%20Further%20progress%20of%20reception%20is%20achieved%20thanks%20to%20DMA%20services%2c%20transferring%20automatically%20received%20data%20elements%20in%20user%20reception%20buffer%20and%20calling%20registered%20callbacks%20at%20half%2fend%20of%20reception.%20UART%20IDLE%20events%20are%20also%20used%20to%20consider%20reception%20phase%20as%20ended.%20In%20all%20cases%2c%20callback%20execution%20will%20indicate%20number%20of%20received%20data%20elements." aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f&t=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#使用hal的串口dma>使用HAL的串口DMA</a><ul><li><a href=#之前遇到的问题>之前遇到的问题</a></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">STM32通过DMA接收不定长串口数据</h1><div class=meta><span class=author itemprop=author itemscope itemtype=http://schema.org/Person><span itemprop=name style=display:none>Garson
</span><span itemprop=url style=display:none>https://github.com/garsonbb</span></span><div class=postdate><time datetime="2022-02-06 12:46:00 +0800 +0800" itemprop=datePublished>2022-02-06</time></div><div class=article-read-time><i class="far fa-clock"></i>
6 minute read</div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/sensor rel=tag>Sensor</a>
,
<a class=tag-link href=/tags/dma rel=tag>DMA</a>
,
<a class=tag-link href=/tags/uart rel=tag>Uart</a></div></div></header><div class=content itemprop=articleBody><p>半年多前做课设，用到HAL库，体验上，用STM32CubeMX和HAL库开发真的很快，但是代码效率确实低不少。
在课设中GPS模块用的串口传输。为了处理接收方便，使用串口的Idle中断来实现串口的不定长接收，再配合DMA就可以减轻CPU负担，把算力分配到更重要的任务上。文中讨论内容适用于Normal模式的DMA。</p><blockquote><p>Idle中断就是空闲中断，当总线上在一个字节对应的周期内未再有新的数据接收时，就会触发中断。</p></blockquote><h2 id=使用hal的串口dma>使用HAL的串口DMA</h2><p>在STM32CubeMX里面的配置就不说了。
主要用到下面两个函数：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>HAL_StatusTypeDef <span style=color:#50fa7b>HAL_UARTEx_ReceiveToIdle_DMA</span>(UART_HandleTypeDef <span style=color:#ff79c6>*</span>huart, <span style=color:#8be9fd>uint8_t</span> <span style=color:#ff79c6>*</span>pData, <span style=color:#8be9fd>uint16_t</span> Size)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>__weak <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>HAL_UARTEx_RxEventCallback</span>(UART_HandleTypeDef <span style=color:#ff79c6>*</span>huart, <span style=color:#8be9fd>uint16_t</span> Size)
</span></span></code></pre></div><p><code>HAL_UARTEx_RxEventCallback()</code>是串口事件回调函数之一。</p><blockquote><p>Reception is initiated by this function call. Further progress of reception is achieved thanks to DMA services, transferring automatically received data elements in user reception buffer and calling registered callbacks at half/end of reception. UART IDLE events are also used to consider reception phase as ended. In all cases, callback execution will indicate number of received data elements.</p></blockquote><p>在DMA半传输完成，传输完成和串口产生Idle中断时，都会触发这个回调函数。因为这个函数在HAL库中是__weak定义，就是要自己在外部再定义重名的回调函数来处置自己需要的工作。</p><p><code>HAL_UARTEx_ReceiveToIdle_DMA(UART_HandleTypeDef *huart, uint16_t Size)</code>
需要调用这个函数才会进入接收状态。Size被设置到DMA相关寄存器中的<strong>CNDTR</strong>项，当DMA传数据输量达到Size的一半是会触发<em>DMA_IT_HT</em>中断，触发回调函数<code>HAL_UARTEx_RxEventCallback()</code>；当DMA传数据输量达到Size是会触发<em>DMA_IT_TC</em>中断，同样调用回调函数。
其中DMA_IT_HT和DMA_IT_TC是由DMA产生，Idle中断由串口产生。</p><h3 id=之前遇到的问题>之前遇到的问题</h3><p>当时做课设时，发现接收数据到Size一半就会触发回调函数，但是那时赶着完成课设，没有深究，也忘记了DMA有半传输完成中断，就直接把Size和接收数组变成待接收数据最大长度的两倍。糊弄过去了。</p><p>现在想一想怎么避免半传输完成对传输的影响。</p><ol><li><code>HAL_UARTEx_RxEventCallback()</code>函数只有两个参数，Size和huart都与事件类型无关，则无法通过参数分辨事件类型。</li><li>HAL库中是先去除中断标志位再调用回调函数，所以没办法在回调函数中通过查询中断标志位判断事件类型。<code>HAL库中是先去除中断标志位再调用回调函数，详细看这个版本的HAL库STM32Cube FW_F4 V1.26.1。stm32f1xx_hal_uart.c中的3591行。</code></li><li>在每次调用<code>HAL_UARTEx_ReceiveToIdle_DMA()</code>后马上关闭半传输中断。但这样我觉得会在某些情况下引发问题。</li><li>修改库函数，在HAL库中修改<code>HAL_UARTEx_ReceiveToIdle_DMA()</code>，在函数内部修改掉会导致半传输中断的代码。</li></ol><p>综上，没有什么好的办法，因为我觉得没到不得已地步不应该去修改库文件。</p><p>在HAL库中，回调函数的风格都是每个事件只会触发一个函数名语义化对应的函数。比如，</p><ul><li><code>HAL_UART_TxHalfCpltCallback</code></li><li><code>HAL_UART_TxCpltCallback</code></li><li><code>HAL_UART_RxHalfCpltCallback</code></li><li><code>HAL_UART_RxCpltCallback</code></li></ul><p>但是<code>HAL_UARTEx_RxEventCallback</code>这个函数处理了4个事件，半传输完成，传输完成，Idle中断，传输出错。与Hal库一贯风格不像，或许以后会重新修改这个函数吧。</p><p>HAL_UARTEx_RxEventCallback使用的例子。<a href=https://github.com/garsonbb/Mini-Quadcopter-Sensor-Demo/blob/main/Lib/GL9306/gl9306.c>传送门</a></p></div></article><div class=blog-post-comments><div id=twikoo_thread><script>var script=document.createElement("script");script.src="https://cdnjs.cloudflare.com/ajax/libs/twikoo/1.6.4/twikoo.min.js",document.getElementById("twikoo_thread").appendChild(script),script.onload=function(){twikoo.init({envId:"https://comments.garnote.top/",el:"#twikoo_thread",lang:"zh-hans"})}</script></div></div><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/post>Writings</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li><li><a href=/search>Search</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#使用hal的串口dma>使用HAL的串口DMA</a><ul><li><a href=#之前遇到的问题>之前遇到的问题</a></li></ul></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f&text=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f&title=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f&is_video=false&description=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae&body=Check out this article: https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f&title=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f&title=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f&name=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae&description=%e5%8d%8a%e5%b9%b4%e5%a4%9a%e5%89%8d%e5%81%9a%e8%af%be%e8%ae%be%ef%bc%8c%e7%94%a8%e5%88%b0HAL%e5%ba%93%ef%bc%8c%e4%bd%93%e9%aa%8c%e4%b8%8a%ef%bc%8c%e7%94%a8STM32CubeMX%e5%92%8cHAL%e5%ba%93%e5%bc%80%e5%8f%91%e7%9c%9f%e7%9a%84%e5%be%88%e5%bf%ab%ef%bc%8c%e4%bd%86%e6%98%af%e4%bb%a3%e7%a0%81%e6%95%88%e7%8e%87%e7%a1%ae%e5%ae%9e%e4%bd%8e%e4%b8%8d%e5%b0%91%e3%80%82%20%e5%9c%a8%e8%af%be%e8%ae%be%e4%b8%adGPS%e6%a8%a1%e5%9d%97%e7%94%a8%e7%9a%84%e4%b8%b2%e5%8f%a3%e4%bc%a0%e8%be%93%e3%80%82%e4%b8%ba%e4%ba%86%e5%a4%84%e7%90%86%e6%8e%a5%e6%94%b6%e6%96%b9%e4%be%bf%ef%bc%8c%e4%bd%bf%e7%94%a8%e4%b8%b2%e5%8f%a3%e7%9a%84Idle%e4%b8%ad%e6%96%ad%e6%9d%a5%e5%ae%9e%e7%8e%b0%e4%b8%b2%e5%8f%a3%e7%9a%84%e4%b8%8d%e5%ae%9a%e9%95%bf%e6%8e%a5%e6%94%b6%ef%bc%8c%e5%86%8d%e9%85%8d%e5%90%88DMA%e5%b0%b1%e5%8f%af%e4%bb%a5%e5%87%8f%e8%bd%bbCPU%e8%b4%9f%e6%8b%85%ef%bc%8c%e6%8a%8a%e7%ae%97%e5%8a%9b%e5%88%86%e9%85%8d%e5%88%b0%e6%9b%b4%e9%87%8d%e8%a6%81%e7%9a%84%e4%bb%bb%e5%8a%a1%e4%b8%8a%e3%80%82%e6%96%87%e4%b8%ad%e8%ae%a8%e8%ae%ba%e5%86%85%e5%ae%b9%e9%80%82%e7%94%a8%e4%ba%8eNormal%e6%a8%a1%e5%bc%8f%e7%9a%84DMA%e3%80%82%0aIdle%e4%b8%ad%e6%96%ad%e5%b0%b1%e6%98%af%e7%a9%ba%e9%97%b2%e4%b8%ad%e6%96%ad%ef%bc%8c%e5%bd%93%e6%80%bb%e7%ba%bf%e4%b8%8a%e5%9c%a8%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e5%af%b9%e5%ba%94%e7%9a%84%e5%91%a8%e6%9c%9f%e5%86%85%e6%9c%aa%e5%86%8d%e6%9c%89%e6%96%b0%e7%9a%84%e6%95%b0%e6%8d%ae%e6%8e%a5%e6%94%b6%e6%97%b6%ef%bc%8c%e5%b0%b1%e4%bc%9a%e8%a7%a6%e5%8f%91%e4%b8%ad%e6%96%ad%e3%80%82%0a%e4%bd%bf%e7%94%a8HAL%e7%9a%84%e4%b8%b2%e5%8f%a3DMA%20%e5%9c%a8STM32CubeMX%e9%87%8c%e9%9d%a2%e7%9a%84%e9%85%8d%e7%bd%ae%e5%b0%b1%e4%b8%8d%e8%af%b4%e4%ba%86%e3%80%82%20%e4%b8%bb%e8%a6%81%e7%94%a8%e5%88%b0%e4%b8%8b%e9%9d%a2%e4%b8%a4%e4%b8%aa%e5%87%bd%e6%95%b0%ef%bc%9a%0a1HAL_StatusTypeDef%20HAL_UARTEx_ReceiveToIdle_DMA%28UART_HandleTypeDef%20%2ahuart%2c%20uint8_t%20%2apData%2c%20uint16_t%20Size%29%202%203__weak%20void%20HAL_UARTEx_RxEventCallback%28UART_HandleTypeDef%20%2ahuart%2c%20uint16_t%20Size%29%20HAL_UARTEx_RxEventCallback%28%29%e6%98%af%e4%b8%b2%e5%8f%a3%e4%ba%8b%e4%bb%b6%e5%9b%9e%e8%b0%83%e5%87%bd%e6%95%b0%e4%b9%8b%e4%b8%80%e3%80%82%0aReception%20is%20initiated%20by%20this%20function%20call.%20Further%20progress%20of%20reception%20is%20achieved%20thanks%20to%20DMA%20services%2c%20transferring%20automatically%20received%20data%20elements%20in%20user%20reception%20buffer%20and%20calling%20registered%20callbacks%20at%20half%2fend%20of%20reception.%20UART%20IDLE%20events%20are%20also%20used%20to%20consider%20reception%20phase%20as%20ended.%20In%20all%20cases%2c%20callback%20execution%20will%20indicate%20number%20of%20received%20data%20elements." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fgarnote.top%2fpost%2fstm32_hal_dma_uart%2f&t=STM32%e9%80%9a%e8%bf%87DMA%e6%8e%a5%e6%94%b6%e4%b8%8d%e5%ae%9a%e9%95%bf%e4%b8%b2%e5%8f%a3%e6%95%b0%e6%8d%ae" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2024 Garson</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/post>Writings</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li><li><a href=/search>Search</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js></script><script src=/js/zoom.js></script><script src=/js/code-copy.js></script></html>