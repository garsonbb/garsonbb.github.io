<!doctype html><html lang=zh-hans>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=HandheldFriendly content="True">
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta http-equiv=cache-control content="no-transform">
<meta http-equiv=cache-control content="no-siteapp">
<meta name=generator content="Hugo 0.86.0">
<link rel="shortcut icon" href=https://pic.garnote.top/2021/08/11/eeb6915d14722.ico>
<title>如何得到模糊控制离线控制表？手算和Matlab - 梦渡</title>
<meta name=author content="Garson">
<meta name=description content="Garson的私人博客">
<meta name=keywords content="控制">
<meta property="og:title" content="如何得到模糊控制离线控制表？手算和Matlab">
<meta name=twitter:title content="如何得到模糊控制离线控制表？手算和Matlab">
<meta property="og:type" content="article">
<meta property="og:url" content="https://garnote.top/post/fuzzyctrl/"><meta property="og:description" content>
<meta name=twitter:description content><meta name=twitter:card content="summary"><meta property="article:published_time" content="2020-03-29T17:54:00+00:00"><meta property="article:modified_time" content="2020-03-29T17:54:00+00:00">
<style>@media(prefers-color-scheme:dark){body[data-theme=auto] img{filter:brightness(60%)}}body[data-theme=dark] img{filter:brightness(60%)}</style>
<link rel=stylesheet href=https://garnote.top/assets/css/fuji.min.css>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-143236801-1')</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-143236801-1"></script>
</head>
<body data-theme=auto data-theme-auto=true>
<script data-cfasync=false>var fujiThemeData=localStorage.getItem('fuji_data-theme');fujiThemeData?fujiThemeData!=='auto'&&document.body.setAttribute('data-theme',fujiThemeData==='dark'?'dark':'light'):localStorage.setItem('fuji_data-theme','auto')</script>
<header>
<div class="container-lg clearfix">
<div class="col-12 header">
<a class=title-main href=https://garnote.top>梦渡</a>
<span class=title-sub>Garson's Note</span>
</div>
</div>
</header>
<main>
<div class="container-lg clearfix">
<div class="col-12 col-md-9 float-left content">
<article>
<h2 class="post-item post-title">
<a href=https://garnote.top/post/fuzzyctrl/>如何得到模糊控制离线控制表？手算和Matlab</a>
</h2>
<div class="post-item post-meta">
<span><i class="iconfont icon-today-sharp"></i>&nbsp;2020-03-29</span>
<span><i class="iconfont icon-file-tray-sharp"></i>&nbsp;733 字</span>
<span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;<a href=/tags/%E6%8E%A7%E5%88%B6>控制</a>&nbsp;</span>
</div>
<div class="post-content markdown-body">
<h2 id=手算>手算</h2>
<p>这里用的模糊逻辑表是模糊PID中<a href=https://garnote.top/archives/fuzzyPID.html target=_blank>P的表</a>。</p>
<ol>
<li>先摆上我的隶属度表</li>
</ol>
<table>
<thead>
<tr>
<th style=text-align:center>状态变量量化等级</th>
<th style=text-align:center>-4</th>
<th style=text-align:center>-3</th>
<th style=text-align:center>-2</th>
<th style=text-align:center>-1</th>
<th style=text-align:center>0</th>
<th style=text-align:center>1</th>
<th style=text-align:center>2</th>
<th style=text-align:center>3</th>
<th style=text-align:center>4</th>
</tr>
</thead>
<tbody>
<tr>
<td style=text-align:center>NB</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0.5</td>
<td style=text-align:center>1</td>
</tr>
<tr>
<td style=text-align:center>NM</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0.2</td>
<td style=text-align:center>1</td>
<td style=text-align:center>0.2</td>
<td style=text-align:center>0</td>
</tr>
<tr>
<td style=text-align:center>NS</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0.1</td>
<td style=text-align:center>1</td>
<td style=text-align:center>0.4</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
</tr>
<tr>
<td style=text-align:center>ZO</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0.2</td>
<td style=text-align:center>1</td>
<td style=text-align:center>0.2</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
</tr>
<tr>
<td style=text-align:center>PS</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0.4</td>
<td style=text-align:center>1</td>
<td style=text-align:center>0.1</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
</tr>
<tr>
<td style=text-align:center>PM</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0.2</td>
<td style=text-align:center>1</td>
<td style=text-align:center>0.2</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
</tr>
<tr>
<td style=text-align:center>PB</td>
<td style=text-align:center>1</td>
<td style=text-align:center>0.5</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
<td style=text-align:center>0</td>
</tr>
</tbody>
</table>
<ol start=2>
<li>计算过程看下面的图吧。
<ul>
<li>计算的法则，两个值交取最小，两个值并取最大。</li>
<li>图中产生的4条模糊规则，但是实际只有两个结果，PB和PM，则两个PB取并集，两个PM取并集。得到两个对应值。
<img class=img-zoomable src=https://pic.garnote.top/2020/03/30/1267b58c429de.png alt=计算过程>
</li>
</ul>
</li>
</ol>
<hr>
<h2 id=matlab计算>Matlab计算</h2>
<ol>
<li>
<p>在命令行输入<code>fuzzy</code>打开模糊工具箱，设置两个输入。
<img class=img-zoomable src=https://pic.garnote.top/2020/03/20/188f7cc12091b.png alt=fuzzytool>
</p>
</li>
<li>
<p>配置隶属度函数，我这里是三个隶属度函数都一样。然后导出。我导出的是P.fis。
<img class=img-zoomable src=https://pic.garnote.top/2020/03/20/44f6189838dcb.png alt=隶属度函数>
</p>
</li>
<li>
<p>打开simulink，构建以下的系统。如果模块的名字不知道可以下面的两张图片，图标下面有名字。
<img class=img-zoomable src=https://pic.garnote.top/2020/03/20/805fe8998725e.png alt=system>
双击模糊控制模块来选择模糊工具箱生成的规则。填写路径。
<img class=img-zoomable src=https://pic.garnote.top/2020/03/20/8021f8092dffa.png alt=fuzzylogic>
利用Zero-order-hold来达到离散化的效果。如果在输入的数据里（如下面的Excel截图），设置信号改变的频率是1Hz，那上面的Zero-order-hold的Simpletime是EC的量化等级的数量，下面的Zero-order-hold的Simpletime为1。
<img class=img-zoomable src=https://pic.garnote.top/2020/03/20/b64ad30386e70.png alt=Hold>
<img class=img-zoomable src=https://pic.garnote.top/2020/03/29/4dc93b2f60d11.png alt=Hold>
</p>
</li>
<li>
<p>在Simulink内打开Testmanger。选择需要测试的系统，根据数据长度选择测试的时长。并导入数据。导入数据后要Map通过才行。
<img class=img-zoomable src=https://pic.garnote.top/2020/03/20/39e976f3180a9.png alt=Model>
<img class=img-zoomable src=https://pic.garnote.top/2020/03/20/08ba64229d48d.png alt=data>
</p>
</li>
<li>
<p>点Run开始测试模型，一瞬间就就计算完了。
<img class=img-zoomable src=https://pic.garnote.top/2020/03/20/0e9d4607ca41f.png alt=计算结果>
<img class=img-zoomable src=https://pic.garnote.top/2020/03/20/64ea74202573c.png alt=输入的数据>
</p>
</li>
<li>
<p>右键P/output，导出到工作区。使用下面这段代码就可以导出成Excel。代码需要根据你的量化等级数量修改</p>
<pre><code class=language-matlab>U = [];
for i = 1:81 % count of all cell in the table
U(i) = getdatasamples(tableP,i); % tableP: 导出的数据
end
E = -4:1:4;
data=[];
data(:,1) = E';
for i = 1:9 % 9是Ec的数量
data(i,2:10) = round(U(1+9*(i-1):9*i)); % 2:10 excel的行单元格
%data(i,2:10) = U(1+9*(i-1):9*i); %直接输出浮点型
end
[m, n] = size(data);
data_cell = num2cell(data);
title = {'E\EC','-4', '-3', '-2', '-1','0', '1', '2', '3', '4'};% universe
result = [title; data_cell];
s = xlswrite('Fuzzy_P.xlsx', result);
</code></pre>
<p><img class=img-zoomable src=https://pic.garnote.top/2020/03/20/4ae1fc85fe3d3.png alt=output>
</p>
</li>
<li>
<p>完成了</p>
</li>
</ol>
</div>
</article>
<div class="license markdown-body">
<blockquote>
<p>除特殊注明部分，本站内容采用 <a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a> 进行许可。</p>
</blockquote>
</div>
<div id=tcomment></div>
<script src=https://cdn.jsdelivr.net/npm/twikoo@1.4.5/dist/twikoo.all.min.js></script>
<script>twikoo.init({envId:'https://comments.garnote.top/',el:'#tcomment'})</script>
</div>
<aside class="col-12 col-md-3 float-left sidebar">
<div class="sidebar-item sidebar-pages">
<h3>页面</h3>
<ul>
<li>
<a href=/>Home</a>
</li>
<li>
<a href=/archives/>Archives</a>
</li>
<li>
<a href=/board/>Board</a>
</li>
<li>
<a href=/about/>About</a>
</li>
<li>
<a href=/search/>Search</a>
</li>
<li>
<a href=/index.xml>RSS</a>
</li>
</ul>
</div>
<div class="sidebar-item sidebar-links">
<h3>链接</h3>
<ul>
<li>
<a href=https://github.com/garsonbb target=_blank><span>GitHub</span></a>
</li>
<li>
<a href=https://space.bilibili.com/12225878 target=_blank><span>Bilibili</span></a>
</li>
<li>
<a href=mailto:z1195224900@gmail.com target=_blank><span>Email</span></a>
</li>
</ul>
</div>
<div class="sidebar-item sidebar-tags">
<h3>标签</h3>
<div>
<span>
<a href=/tags/clion/>Clion</a>
</span>
<span>
<a href=/tags/diy/>DIY</a>
</span>
<span>
<a href=/tags/nas/>Nas</a>
</span>
<span>
<a href=/tags/stm32/>STM32</a>
</span>
<span>
<a href=/tags/unraid/>Unraid</a>
</span>
<span>
<a href=/tags/%E6%8E%A7%E5%88%B6/>控制</a>
</span>
<span>
<a href=/tags/%E6%91%84/>摄</a>
</span>
<span>
<a href=/tags/%E6%97%A5%E5%B8%B8/>日常</a>
</span>
<span>
<a href=/tags/%E6%9D%82/>杂</a>
</span>
</div>
</div>
<div class="sidebar-item sidebar-toc">
<h3>目录</h3><nav id=TableOfContents>
<ul>
<li>
<ul>
<li><a href=#手算>手算</a></li>
<li><a href=#matlab计算>Matlab计算</a></li>
</ul>
</li>
</ul>
</nav></div>
</aside>
</div>
<div class=btn>
<div class=btn-menu id=btn-menu>
<i class="iconfont icon-grid-sharp"></i>
</div>
<div class=btn-toggle-mode>
<i class="iconfont icon-contrast-sharp"></i>
</div>
<div class=btn-scroll-top>
<i class="iconfont icon-chevron-up-circle-sharp"></i>
</div>
</div>
<aside class=sidebar-mobile style=display:none>
<div class=sidebar-wrapper>
<div class="sidebar-item sidebar-pages">
<h3>页面</h3>
<ul>
<li>
<a href=/>Home</a>
</li>
<li>
<a href=/archives/>Archives</a>
</li>
<li>
<a href=/board/>Board</a>
</li>
<li>
<a href=/about/>About</a>
</li>
<li>
<a href=/search/>Search</a>
</li>
<li>
<a href=/index.xml>RSS</a>
</li>
</ul>
</div>
<div class="sidebar-item sidebar-links">
<h3>链接</h3>
<ul>
<li>
<a href=https://github.com/garsonbb target=_blank><span>GitHub</span></a>
</li>
<li>
<a href=https://space.bilibili.com/12225878 target=_blank><span>Bilibili</span></a>
</li>
<li>
<a href=mailto:z1195224900@gmail.com target=_blank><span>Email</span></a>
</li>
</ul>
</div>
<div class="sidebar-item sidebar-tags">
<h3>标签</h3>
<div>
<span>
<a href=/tags/clion/>Clion</a>
</span>
<span>
<a href=/tags/diy/>DIY</a>
</span>
<span>
<a href=/tags/nas/>Nas</a>
</span>
<span>
<a href=/tags/stm32/>STM32</a>
</span>
<span>
<a href=/tags/unraid/>Unraid</a>
</span>
<span>
<a href=/tags/%E6%8E%A7%E5%88%B6/>控制</a>
</span>
<span>
<a href=/tags/%E6%91%84/>摄</a>
</span>
<span>
<a href=/tags/%E6%97%A5%E5%B8%B8/>日常</a>
</span>
<span>
<a href=/tags/%E6%9D%82/>杂</a>
</span>
</div>
</div>
<div class="sidebar-item sidebar-toc">
<h3>目录</h3>
<nav id=TableOfContents>
<ul>
<li>
<ul>
<li><a href=#手算>手算</a></li>
<li><a href=#matlab计算>Matlab计算</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</aside>
</main>
<footer>
<div class="container-lg clearfix">
<div class="col-12 footer">
<span>&copy; 2019-2021
<a href=https://garnote.top>Garson</a>
| <a href=https://github.com/dsrkafuu/hugo-theme-fuji>Source code</a>
| 基于 <a href=https://github.com/dsrkafuu/hugo-theme-fuji/ target=_blank>Fuji-v2</a> & <a href=https://gohugo.io/ target=_blank>Hugo</a> 构建
</span>
</div>
</div>
</footer>
<script defer src=https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js></script>
<script defer src=/assets/js/fuji.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script>
</body>
</html>