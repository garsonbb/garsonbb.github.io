<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts on Garson's Blog</title><link>https://garnote.top/post/</link><description>Recent content in Posts on Garson's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-hans</language><copyright>Garson</copyright><lastBuildDate>Sun, 12 Sep 2021 21:05:36 +0800</lastBuildDate><atom:link href="https://garnote.top/post/index.xml" rel="self" type="application/rss+xml"/><item><title>Win10关机后马上自动重启</title><link>https://garnote.top/post/win10_reboot/</link><pubDate>Sun, 12 Sep 2021 21:05:36 +0800</pubDate><guid>https://garnote.top/post/win10_reboot/</guid><description>🤯 自我的主板从x470i更换到b350后，电脑用点左下角的win菜单关机的话就自动重启，无法关机。要到powershell里面执行shutdown才能正常关机。
查了一下类似的现象的文章，确定了是快速启动的问题。把开始启动关了，确实可以正常关机了，但是这治标不治本。有快速启动为什么不用。👿
在一篇博文中，发现可能是win10没有识别默认的系统，打开msconfig里面的引导一看，确实是空的。
最后用easybcd修复就好了。</description></item><item><title>四元数姿态解算-MahonyAHRS</title><link>https://garnote.top/post/mahonyahrs/</link><pubDate>Wed, 26 May 2021 00:17:00 +0000</pubDate><guid>https://garnote.top/post/mahonyahrs/</guid><description>加速度计和角速度计解算姿态 在只使用加速度计和陀螺仪融合数据时，流程是这样的：
归一化传感器输入的B系加速度 $ {\begin{bmatrix}b\_a_x &amp;amp; b\_a_y &amp;amp; b\_a_z\end{bmatrix}}^\top $ 。 把N系重力加速度旋转到B系 $ {\begin{bmatrix}n2b\_a_x &amp;amp; n2b\_a_y &amp;amp; n2b\_a_z\end{bmatrix}}^\top $ 。 N系重力加速度就是g， $ {\begin{bmatrix} 0 &amp;amp; 0 &amp;amp; 1\end{bmatrix}}^\top $。 把上面两个同在B系的加速度进行叉积运算，得到误差 $ {\begin{bmatrix}e\_a_x &amp;amp; e\_a_y &amp;amp; e\_a_z\end{bmatrix}}^\top $ 。（得到误差反映的就是目前解算得到的姿态矩阵与真实姿态之间的误差）。 把上面获得的误差通过PI控制器补偿到传感器输入的角速度。 $ {\begin{bmatrix}b\_g_x &amp;amp; b\_g_y &amp;amp; b\_g_z\end{bmatrix}}^\top $ 。 使用上面已经补偿的角速度和一阶龙塔公式更新四元数。 归一化四元数。 在这个过程中，就是利用重力加速度恒等于1g并垂直向下，来修正由角速度积分得到的姿态矩阵。
接下来确定旋转矩阵的方向：
由 $ q_0=\cos{\frac{\theta}{2}} \quad ,q_1= - \sin{\frac{\theta}{2}}\hat{x} \quad , q_2= - \sin{\frac{\theta}{2}}\hat{y} \quad ,q_3= - \sin{\frac{\theta}{2}}\hat{z} $ 可算得下面的两个四元数旋转矩阵。具体计算过程可以看</description></item><item><title>解决多种原因导致的STM32芯片被锁定</title><link>https://garnote.top/post/stm32_locked/</link><pubDate>Wed, 26 May 2021 00:16:00 +0000</pubDate><guid>https://garnote.top/post/stm32_locked/</guid><description>stm32cubeMX中Debug方式设置错误导致锁定芯片 昨天用clion和stm32cubeMX调试。创建好Project之后，忘记在cubeMX，SYS选项卡中选择DEBUG为Serial Wire。然后直接在clion中下载程序。然后下载失败，芯片锁了。我的daplink和jlink都认不出来了。
购买到二手拆机片 这段时间，芯片价格涨价。买了几个二手拆机片，都是设置了只读，或者是还有程序在芯片里跑。我直接用daplink下载程序，只是提示下载失败。我不太懂DAPLink的使用。插上JLink后，在Keil中的Debug选项卡中识别到芯片之后，弹出： 出现这个，应该有这几种可能
芯片坏了 芯片读保护 芯片焊接有问题，NRST复位按钮那里有问题 解决方法 下载安装JLink的工具包https://www.segger.com/downloads/jlink/#J-LinkSoftwareAndDocumentationPack Debug方式设置错误导致锁定芯片 打开J-Flash Lite选择对应芯片，我的是STM32F103C8。之后，点Erase Chip。是不行的，似乎不能Reset芯片。 所以之后手动，点了Erase Chip，快速多次按PCB上的Reset按钮，提示Reset 🆗马上停下，这样就可以清空芯片。芯片也可以被识别了。
购买到二手拆机片 打开J-Flash V6.98a，Create new project 选择你对应的芯片 连接MCU 擦除芯片 先解锁芯片，再擦除。 一般到这就修好了，不然可能芯片坏了（电路没焊接错的话） 其他情况 打开STM32 Unlock 看到命令行窗口，输入你使用的芯片系列对应的数字。</description></item><item><title>使用Maltab设计二阶互补滤波器</title><link>https://garnote.top/post/butter_matlab/</link><pubDate>Mon, 05 Apr 2021 21:10:00 +0000</pubDate><guid>https://garnote.top/post/butter_matlab/</guid><description>1clear,clc % HPF 2 3N = 2; % 二阶 4fs=1000; % 采样率Hz 5fc=50; % 3dB截止频率 6OmegaC=(fc*2*pi/1000) /pi; % 截止频率归一化 7 8[ b, a ] = butter(N,OmegaC,&amp;#39;HIGH&amp;#39;); 9 10freqz(b,a); 1clear,clc % LPF 2 3N = 2; % 二阶 4fs=1000; % 采样率Hz 5fc=50; % 3dB截止频率 6OmegaC=(fc*2*pi/1000) /pi; % 截止频率归一化 7 8[ b, a ] = butter(N,OmegaC,&amp;#39;LOW&amp;#39;); 9 10freqz(b,a); butter函数说明https://ww2.mathworks.cn/help/signal/ref/butter.html，默认是生成数字滤波器的传递函数系数，用双线性变换从模拟滤波器转为数字滤波器。
得到传递函数的系数b,a。进行反z变换到离散域，就可以得到差分方程。
$$ \frac{Y(z)_{zs}}{X(z)}=H(z)=\frac{B(z)}{A(z)} $$
$$ B(z)=\sum_{j=0}^m{b_{m-j}z^{-j}}=b_m+b_{m-1}z^{-1}+&amp;hellip;+b_0z^{-m} \\\ A(z)=\sum_{i=0}^n{a_{n-i}z^{-i}}=a_n+a_{n-1}z^{-1}+&amp;hellip;+a_0z^{-n} $$
在Matlab得到的[ b, a ]中，$b = [b_{m},b_{m-1}, \ &amp;hellip;\ ,b_{0}]，a = [a_{n},a_{n-1}, \ &amp;hellip;\ ,a_{0}]$</description></item><item><title>在使用unraid遇到的问题</title><link>https://garnote.top/post/unraid/</link><pubDate>Tue, 16 Feb 2021 15:43:00 +0000</pubDate><guid>https://garnote.top/post/unraid/</guid><description>安装win虚拟机 在win安装时，会看不到虚拟的硬盘。
所以在virtio-win-xxx这个光盘中依次找到以下驱动安装
Balloon NetKVM vioserial viostor 之后就可以看到硬盘了。
nps内网穿透 首先不建议在在docker中使用nps。
npcDocker的网络模式是bridge时，不能通过局域网ip访问网络模式是custom:br的docker。
npcDocker的网络模式是custom:br时，不能通过局域网ip访问网络模式是bridge的docker。
为什么custom:br会这样，我在unraid论坛找到这样的描述。
Bridge mode
shares IP with unRAID usually ok but sometimes annoying because container wants a specific port that&amp;rsquo;s already in use by unRAID or another container. your network cannot distinguish between container traffic and NAS services (hard to perform QoS or specific VPN routing) Custom eth0/br0
allows your container to have a different IP from unRAID.</description></item><item><title>使用CLion开发-STM32F4开启FPU并调用DSP库</title><link>https://garnote.top/post/94/</link><pubDate>Wed, 06 Jan 2021 12:47:00 +0000</pubDate><guid>https://garnote.top/post/94/</guid><description>下载DSP库 可以在ST官网下载 可以在Arm这下载最新版本的库https://github.com/ARM-software/CMSIS_5/releases 下载.pack，用压缩软件打开查看 进入CMSIS\DSP\Lib\GCC\提取libarm_cortexM4lf_math.a 进入CMSIS\DSP\Include\提取arm_math.h 在CMakeList.txt中添加链接 1include_directories(包含arm_math.h的文件夹路径) 2target_link_libraries(${PROJECT_NAME}.elf ${CMAKE_SOURCE_DIR}/...你自己的路径/libarm_cortexM4lf_math.a) 开启FPU 只需要在CMakeLists中#Uncomment for hardware floating point下的配置去除注释就可以了，不需要额外的define标签。 之所以不用像Keil一样额外的define，因为在stm32f407xx.h(2017)中第52行默认是已经是 #define __FPU_PRESENT 1U， 而且在core_cm4.h(V5.0.8)中第100行，在__GNUC__默认是 #define __FPU_USED 1U</description></item><item><title>哪颗星是您？</title><link>https://garnote.top/post/91/</link><pubDate>Tue, 10 Nov 2020 22:12:23 +0000</pubDate><guid>https://garnote.top/post/91/</guid><description>哪颗星是您？</description></item><item><title>模糊PID用到的模糊逻辑表</title><link>https://garnote.top/post/fuzzypid/</link><pubDate>Mon, 30 Mar 2020 17:13:00 +0000</pubDate><guid>https://garnote.top/post/fuzzypid/</guid><description/></item><item><title>如何得到模糊控制离线控制表？手算和Matlab</title><link>https://garnote.top/post/fuzzyctrl/</link><pubDate>Sun, 29 Mar 2020 17:54:00 +0000</pubDate><guid>https://garnote.top/post/fuzzyctrl/</guid><description>手算 这里用的模糊逻辑表是模糊PID中P的表。
先摆上我的隶属度表 状态变量量化等级 -4 -3 -2 -1 0 1 2 3 4 NB 0 0 0 0 0 0 0 0.5 1 NM 0 0 0 0 0 0.2 1 0.2 0 NS 0 0 0 0 0.1 1 0.4 0 0 ZO 0 0 0 0.2 1 0.2 0 0 0 PS 0 0 0.</description></item><item><title>pid控制的倒立摆</title><link>https://garnote.top/post/pid_pendulum/</link><pubDate>Wed, 05 Feb 2020 16:25:00 +0000</pubDate><guid>https://garnote.top/post/pid_pendulum/</guid><description>做一个倒立摆 这个倒立摆，一开始是打算用自己做的结构，用木板和铝型材搭，用57步进电机驱动。这个结构有很大的问题，步进电机悬空，下盘不稳，很容易就整个结构一起震动，难以平衡。没上导线环，会绕线。只剩一张他的遗照了。
图里还用了一个木制法兰盘23333用502做的（简直是魔鬼），连接到转轴上也是用502. 接下来直接去淘宝买了一套结构.
关键的代码也就是下面两个pid环。
两个pid环的代码 int PID_Angle_Cal(int ang_Now, int ang_Target) { float dError,Bias=0; static float iError; Bias = ang_Now - ang_Target; iError += Bias; if (iError&amp;gt; 2200) iError=2200; if (iError&amp;lt;-2200) iError=-2200;//iError上下限 dError = Bias - last_Bias; last_Bias = Bias; return ang_p * Bias + ang_i * iError + ang_d * dError; } int PID_Pos_Cal(int pos_Now, int pos_Target) { float dError; static float Bias,last_Bias,iError; Least = pos_Now - pos_Target; Bias *=0.</description></item><item><title>枯燥无味的2019</title><link>https://garnote.top/post/2019/</link><pubDate>Mon, 03 Feb 2020 11:34:00 +0000</pubDate><guid>https://garnote.top/post/2019/</guid><description>先分享一首音乐。
我的2019 今年是运气很好的一年。
年中成功获得了从应用化学到电子信息类的转专业资格。转专业的考核主要看两点：绩点和面试。我在面试这部分做的很不好，面试的稿子准备不太行，因为我现实比较自闭，十分抗拒向别人表达自己。加之面试时面对10人左右和全程的英文交流，很紧张＞﹏＜，说话一卡一卡，还要忘记单词。我自己都觉得这是一次非常差的面试。幸运的是，我还是顺利的到了信工学院。
年中，参加了全国电子设计大赛。选了仪器题，用一个夹板电容来测出夹板电容之间的A4纸数目。Emmmm，一开始方案确定的时候出了点问题。最后比赛那天，测出的数目都与正确数目有+-一到两张的偏差。最后拿了个参与奖。害，就当是买了个教训。比赛之后，趁着暑假，在淘宝买了机械结构，做了一个倒立摆。学习了一下PID算法（这个倒立摆的文章还没写(/▽＼)）。之后又了解了一下flutter，开始写一个关于bgm.tv的app。写了几天弃坑了。。现在完善一下，直接弃坑。。。（浪费时间）
新学期开始之后。我在学新课的同时，要补修高数，线代，专业导论（虽说逃了挺多）。令我最心态爆炸，平均一个星期3次实验，也就是说，周一到五只有两天有午觉睡（实验一般是13：30或者13：50开始上课）。在前半学期，还有耗两个晚上上选修。(；′⌒`)，过于难受，太累了。
上课真的要控制住自己(ಥ _ ಥ)，不要拿出手机，一看手机就要花时间课后时间来补回来。课后时间真的太宝贵，今年坚决要利用好。
最大的敌人，拖延症，今年还是没有战胜它（这篇文章拖到了今天充分体现了。但是原因一方面是真的拖延，还有一方面是我讨厌写任何文章(ಥ _ ಥ)）。希望今年可以提升自己的执行力和效率吧。</description></item><item><title>Ubuntu下使用Clion+STM32CubeMx+OpenOCD进行开发</title><link>https://garnote.top/post/stm32_clion/</link><pubDate>Fri, 13 Dec 2019 18:15:00 +0000</pubDate><guid>https://garnote.top/post/stm32_clion/</guid><description>Clion 下载地址 利用edu邮箱可以申请免费授权，一年一申。传送门 解压之后在源码目录执行sudo ./clion-2019.3/bin/clion.sh安装。 STM32CubeMx 安装jre.sudo apt install default-jre. 下载STM32CubeMx. 解压之后进入目录执行sudo ./SetupSTM32CubeMX-5.4.0.linux安装(要先给这个文件加上可执行权限)。 arm-none-eabi-gcc 下载arm-none-eabi-gcc 解压到/usr/lib/gcc. vi /etc/profile 在最后一行加入export PATH=$PATH:/usr/lib/gcc/gcc-arm-none-eabi-9-2019-q4-major/bin注意修改目录位置. 重启生效PATH OpenOCD OpenOCD代码托管在这里，选择最新版本下载https://sourceforge.net/projects/openocd/files/openocd/ 解压，进入源码目录 ./configure -help可查看帮助 ./bootstrap生成配置文件 ./configure --enable jlink添加jlink支持，可能会提示缺少什么库，按提示安装 sudo make &amp;amp;&amp;amp; make install安装。重启生效PATH 在源码目录下sudo cp contrib/60-openocd.rules /etc/udev/rule.d/ 不进行这部操作的话，在非root用户下运行Clion时，Clion会无权访问调试器。 最后 运行Clion，在Plugins中搜索stm32并安装第一个插件，重启Clion。New Project 选STM32CubeMX。在STM32CubeMX的Project Settings中，将Toolchain/IDE选成SW4STM32。最后Generate Code. Enjoy it.</description></item><item><title>2019秋</title><link>https://garnote.top/post/44/</link><pubDate>Tue, 29 Oct 2019 13:59:00 +0000</pubDate><guid>https://garnote.top/post/44/</guid><description/></item><item><title>4k-IPS-27寸屏幕（LM270-WR3-SSA1）组装DIY</title><link>https://garnote.top/post/diyascreen/</link><pubDate>Mon, 02 Sep 2019 00:29:00 +0000</pubDate><guid>https://garnote.top/post/diyascreen/</guid><description>屏幕的参数 在一个月前，终于决定把用了4，5年的老屏幕换了。 花了750顺丰包邮了一片全新A屏LM270WR3-SSA1。这是27寸的4k屏幕，100%sRGB色域，抖动10Bit。
华强北驱动板，有2xhdmi，2xdp，支持4k60hz，2k144hz，1080p240hz。好贵啊＞﹏＜。 组装好之后的照片， 别问我为什么用木板作为背板材料。问就是穷。亚克力好贵，cnc更不用说。先用CAD画好图纸，发给淘宝或者拿到附近的加工点制作。必须说一下屏幕的datasheet，我的第一片屏幕的背板是直接完全按照datasheet画的，但是木板切好后一放到屏幕后就发现了有不少的空位偏移了，然后我目测一下孔位偏移的距离，调好后马上再打一版，目测不准，还是不能安装。（哭唧唧）。然后只好拿着丁字尺慢慢量。一共切了3片木板，层叠安装，最里层的1mm，外两层2mm。
总的成本 材料 1449￥ 屏幕 750￥ 背板 100￥ 驱动板 400￥ 电源 13￥ 屏幕支架 130￥ 校色仪 56￥ 校色 忙完开学的事情后，租了i1Display配合displayCal来做最后的校色。校色之后的效果ヾ(•ω•`)o 如果你也是像我一样在淘宝上买华强北驱动板的话，在校色的开始之前，要先把驱动板的设置重置一下，因为我这里试过驱动板显示没有打开的选项但是实际上是打开的。
还有如果你买的是我的同款驱动板，在用displayCal校色的第一步要调整屏幕的RGB分量，要调整这三个量要切换到菜单里的色彩-色温-USER再按确定就可以修改了。</description></item><item><title>MegaHost</title><link>https://garnote.top/post/mega/</link><pubDate>Tue, 23 Jul 2019 13:13:00 +0000</pubDate><guid>https://garnote.top/post/mega/</guid><description>19年7月23日更新的
31.216.147.136 eu.api.mega.co.nz 31.216.147.135 eu.api.mega.co.nz 31.216.147.134 eu.api.mega.co.nz 31.216.148.13 eu.static.mega.co.nz 31.216.148.11 eu.static.mega.co.nz 89.44.169.132 eu.static.mega.co.nz 117.18.237.188 g.cdn1.mega.co.nz 31.216.147.130 mega.co.nz 31.216.148.10 mega.nz 89.44.169.135 mega.nz 31.216.147.156 w.api.mega.co.nz 31.216.147.161 w.api.mega.co.nz 31.216.147.156 w.api.mega.co.nz ipconfig /flushdns</description></item><item><title>surface的U盘启动</title><link>https://garnote.top/post/surface_upgarde/</link><pubDate>Wed, 17 Jul 2019 22:35:00 +0000</pubDate><guid>https://garnote.top/post/surface_upgarde/</guid><description>坑 一开始我不知到苏菲只有UEFI，直接用UltraISO写了个启动盘想装1903的win10用各种办法都不能从U盘启动。。
正确的食用方法 把U盘格式化成FAT32，把ISO解压到U盘根目录。 开机，先长按音量-，再单击电源键即可。 在1.的过程中，你可能要用到
Dism /Split-Image /ImageFile:C:\sources\install.wim /SWMFile:C:\sources\install.swm /FileSize:3900 把install.wim分成几个小的文件得以放入fat32的U盘。（自己修改文件路径
记录一下其他命令 查电池信息
powercfg /BatteryReport</description></item><item><title>stm32官方资源的一些记录</title><link>https://garnote.top/post/stm32_source/</link><pubDate>Fri, 28 Jun 2019 23:40:00 +0000</pubDate><guid>https://garnote.top/post/stm32_source/</guid><description> stm32芯片封装-&amp;gt;点我点我 需要用Ultra Librarian转为常见的Cendence、Altium、Pads格式。 stm32芯片的固件库-&amp;gt;传送门 keil .pack 传送门</description></item><item><title>我又来了！</title><link>https://garnote.top/post/start/</link><pubDate>Thu, 27 Jun 2019 13:26:00 +0000</pubDate><guid>https://garnote.top/post/start/</guid><description>我又来了！ 终于决定把博客从Hexo搬来Typeecho了。主要原因是我的设备比较多，每台机都部署Hexo环境太麻烦了，同步起来也麻烦。更重要的是handsome这个主题很符合我的需求。
立一个Flag，每个月至少写一篇博文。</description></item></channel></rss>